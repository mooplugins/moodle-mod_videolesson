define("mod_videolesson/setup_wizard",["exports","core/toast","core/str"],(function(_exports,Toast,_str){function _getRequireWildcardCache(nodeInterop){if("function"!=typeof WeakMap)return null;var cacheBabelInterop=new WeakMap,cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,Toast=function(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule)return obj;if(null===obj||"object"!=typeof obj&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if("default"!==key&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}newObj.default=obj,cache&&cache.set(obj,newObj);return newObj}
/**
   * Setup Wizard functionality for videolesson plugin
   * UI enhancements only - state management is handled server-side via forms
   *
   * @module     mod_videolesson/setup_wizard
   * @copyright  2022-2026 BitKea Technologies LLP
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */(Toast);const getElement=id=>document.getElementById(id),getElements=selector=>document.querySelectorAll(selector);_exports.init=function(){let initialStep=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;getElements(".step-content").forEach((el=>{el.style.display="none"}));const currentStepEl=getElement("step-".concat(initialStep,"-content"));currentStepEl&&(currentStepEl.style.display=""),getElements(".step-indicator").forEach((el=>{el.classList.remove("current")}));const currentIndicator=document.querySelector('.step-indicator[data-step="'.concat(initialStep,'"]'));currentIndicator&&currentIndicator.classList.add("current");const hostingCards=getElements(".hosting-option-card"),hostingRadios=getElements('input[name="hosting-type"]'),checkedRadio=document.querySelector('input[name="hosting-type"]:checked');if(checkedRadio){const checkedCard=checkedRadio.closest(".hosting-option-card");if(checkedCard){const cardElement=checkedCard.querySelector(".hosting-card");cardElement&&cardElement.classList.add("selected")}}hostingCards.forEach((card=>{card.addEventListener("click",(function(){const radio=this.querySelector('input[type="radio"]');hostingCards.forEach((c=>{const cardElement=c.querySelector(".hosting-card");cardElement&&cardElement.classList.remove("selected")}));const clickedCard=this.querySelector(".hosting-card");clickedCard&&clickedCard.classList.add("selected"),radio&&(radio.checked=!0)}))})),hostingRadios.forEach((radio=>{radio.addEventListener("change",(function(){const card=this.closest(".hosting-option-card");if(card){const cardElement=card.querySelector(".hosting-card");cardElement&&(hostingCards.forEach((c=>{const cardEl=c.querySelector(".hosting-card");cardEl&&cardEl.classList.remove("selected")})),cardElement.classList.add("selected"))}}))}));const step2ValidateBtn=getElement("step2-validate-btn");if(step2ValidateBtn){const checkFormValidity=()=>{var _getElement,_getElement2,_getElement3,_getElement4;const apiKey=null===(_getElement=getElement("aws-api-key"))||void 0===_getElement?void 0:_getElement.value.trim(),apiSecret=null===(_getElement2=getElement("aws-api-secret"))||void 0===_getElement2?void 0:_getElement2.value.trim(),s3InputBucket=null===(_getElement3=getElement("aws-s3-input-bucket"))||void 0===_getElement3?void 0:_getElement3.value.trim(),s3OutputBucket=null===(_getElement4=getElement("aws-s3-output-bucket"))||void 0===_getElement4?void 0:_getElement4.value.trim();step2ValidateBtn.disabled=!(apiKey&&apiSecret&&s3InputBucket&&s3OutputBucket)};["aws-api-key","aws-api-secret","aws-s3-input-bucket","aws-s3-output-bucket"].forEach((fieldId=>{const field=getElement(fieldId);field&&(field.addEventListener("input",checkFormValidity),field.addEventListener("change",checkFormValidity))})),checkFormValidity();const awsForm=document.getElementById("aws-settings-form");awsForm&&step2ValidateBtn&&awsForm.addEventListener("submit",(function(){setTimeout((()=>{step2ValidateBtn.disabled=!0,step2ValidateBtn.dataset.originalHtml||(step2ValidateBtn.dataset.originalHtml=step2ValidateBtn.innerHTML);const buttonText=Array.from(step2ValidateBtn.childNodes).filter((node=>node.nodeType===Node.TEXT_NODE)).map((node=>node.textContent.trim())).join(" ")||"Validating...";step2ValidateBtn.innerHTML='<span class="spinner-border spinner-border-sm mr-2" role="status" aria-hidden="true"></span><i class="fa fa-check-circle"></i> '+buttonText}),10)}))}const hasExistingLicenseCheckbox=getElement("has-existing-license"),existingLicenseField=getElement("existing-license-field"),existingLicenseKeyInput=getElement("existing-license-key"),activateBtn=getElement("activate-btn");if(hasExistingLicenseCheckbox&&existingLicenseField){activateBtn&&!activateBtn.dataset.originalHtml&&(activateBtn.dataset.originalHtml=activateBtn.innerHTML),hasExistingLicenseCheckbox.addEventListener("change",(function(){if(!activateBtn||!activateBtn.disabled)if(this.checked){if(existingLicenseField.style.display="block",existingLicenseKeyInput&&existingLicenseKeyInput.focus(),activateBtn&&activateBtn.dataset.originalHtml){const iconMatch=activateBtn.dataset.originalHtml.match(/<i[^>]*>.*?<\/i>/),icon=iconMatch?iconMatch[0]:'<i class="fa fa-rocket"></i>';activateBtn.innerHTML=icon+" Activate"}}else existingLicenseField.style.display="none",existingLicenseKeyInput&&(existingLicenseKeyInput.value=""),activateBtn&&activateBtn.dataset.originalHtml&&(activateBtn.innerHTML=activateBtn.dataset.originalHtml)}));const form=document.getElementById("step2-hosted-form");form&&activateBtn&&form.addEventListener("submit",(function(e){if("activate_free_hosting"===activateBtn.getAttribute("value")){if(hasExistingLicenseCheckbox.checked){if(!(null==existingLicenseKeyInput?void 0:existingLicenseKeyInput.value.trim()))return e.preventDefault(),(0,_str.get_string)("setup:step2:hosted:existing:license:key:required","mod_videolesson").then((message=>{Toast.add(message,{type:"error"})})),existingLicenseKeyInput&&existingLicenseKeyInput.focus(),!1}setTimeout((()=>{activateBtn.disabled=!0,activateBtn.dataset.originalHtml||(activateBtn.dataset.originalHtml=activateBtn.innerHTML);const buttonText=Array.from(activateBtn.childNodes).filter((node=>node.nodeType===Node.TEXT_NODE)).map((node=>node.textContent.trim())).join(" ")||"Activating...";activateBtn.innerHTML='<span class="spinner-border spinner-border-sm mr-2" role="status" aria-hidden="true"></span><i class="fa fa-rocket"></i> '+buttonText}),10)}}))}}}));

//# sourceMappingURL=setup_wizard.min.js.map