{"version":3,"file":"table.min.js","sources":["../src/table.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Table functionality for videolesson plugin\n *\n * @module     mod_videolesson/table\n * @copyright  2022-2026 BitKea Technologies LLP\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nconst initializedTables = {};\n\n/**\n * Filter table rows based on input value and specified column index.\n * @param {string} tableId - The ID of the table.\n * @param {string} inputId - The ID of the input element.\n * @param {number} columnIndex - The column index to filter.\n */\nconst filterTable = (tableId, inputId, columnIndex) => {\n    const input = document.getElementById(inputId);\n    const filter = input?.value.toLowerCase();\n    const table = document.getElementById(tableId);\n    const rows = table?.getElementsByTagName(\"tr\");\n\n    if (!rows) {\n        return;\n    }\n\n    for (let i = 1; i < rows.length; i++) { // Skip header row\n        const cell = rows[i].getElementsByTagName(\"td\")[columnIndex];\n        if (cell) {\n            const textValue = cell.textContent || cell.innerText;\n            rows[i].style.display = textValue.toLowerCase().includes(filter) ? \"\" : \"none\";\n        }\n    }\n};\n\n/**\n * Sort table rows based on a specific column index.\n * @param {string} tableId - The ID of the table.\n * @param {number} columnIndex - The column index to sort.\n */\nconst sortTable = (tableId, columnIndex) => {\n    const table = document.getElementById(tableId);\n    const rows = Array.from(table?.rows || []).slice(1); // Get all rows except the header\n    if (rows.length === 0) {\n        return;\n    }\n\n    const isNumeric = !isNaN(rows[0].cells[columnIndex].innerText);\n    const sortOrderAttr = `data-sort-order-${columnIndex}`;\n    const ascending = table.getAttribute(sortOrderAttr) !== \"asc\";\n\n    rows.sort((a, b) => {\n        const aValue = a.cells[columnIndex].innerText.toLowerCase();\n        const bValue = b.cells[columnIndex].innerText.toLowerCase();\n\n        if (isNumeric) {\n            return ascending\n                ? parseFloat(aValue) - parseFloat(bValue)\n                : parseFloat(bValue) - parseFloat(aValue);\n        }\n        return ascending\n            ? aValue.localeCompare(bValue)\n            : bValue.localeCompare(aValue);\n    });\n\n    // Toggle sort order\n    table.setAttribute(sortOrderAttr, ascending ? \"asc\" : \"desc\");\n\n    // Append sorted rows back to the table\n    const tbody = table.querySelector(\"tbody\");\n    if (tbody) {\n        tbody.innerHTML = \"\";\n        rows.forEach(row => tbody.appendChild(row));\n    }\n\n    updateSortIndicators(table, columnIndex, ascending);\n};\n\n/**\n * Update sort indicators for the table headers.\n * @param {HTMLElement} table - The table element.\n * @param {number} columnIndex - The sorted column index.\n * @param {boolean} ascending - Whether the sort is ascending.\n */\nconst updateSortIndicators = (table, columnIndex, ascending) => {\n    const headers = table.querySelectorAll(\"th\");\n    headers.forEach((header, index) => {\n        header.setAttribute(\n            \"data-sort-indicator\",\n            index === columnIndex ? (ascending ? \"▲\" : \"▼\") : \"\"\n        );\n    });\n};\n\n/**\n * Initialize a table for sorting and filtering functionality.\n * @param {string} tableId - The ID of the table.\n * @param {string} inputId - The ID of the input field for filtering.\n * @param {number} filterColumnIndex - The index of the column for filtering.\n */\nexport const initTable = (tableId = 'videolist', inputId = 'videolistsearchinput', filterColumnIndex = 2) => {\n\n    if (initializedTables[tableId]) {\n        return;\n    }\n\n    const table = document.getElementById(tableId);\n    if (!table) {\n        return;\n    }\n\n    const headers = table.querySelectorAll(\"th\");\n    headers.forEach((header, index) => {\n        header.addEventListener(\"click\", () => sortTable(tableId, index));\n    });\n\n    const input = document.getElementById(inputId);\n    if (input) {\n        input.addEventListener(\"input\", () => filterTable(tableId, inputId, filterColumnIndex));\n    } else {\n        // Input not found - this is not critical, just disable filtering\n        // Silently fail as this is a non-critical feature\n    }\n\n    initializedTables[tableId] = true;\n};\n"],"names":["initializedTables","filterTable","tableId","inputId","columnIndex","input","document","getElementById","filter","value","toLowerCase","table","rows","getElementsByTagName","i","length","cell","textValue","textContent","innerText","style","display","includes","sortTable","Array","from","slice","isNumeric","isNaN","cells","sortOrderAttr","ascending","getAttribute","sort","a","b","aValue","bValue","parseFloat","localeCompare","setAttribute","tbody","querySelector","innerHTML","forEach","row","appendChild","updateSortIndicators","querySelectorAll","header","index","filterColumnIndex","headers","addEventListener"],"mappings":";;;;;;;;MAuBMA,kBAAoB,GAQpBC,YAAc,CAACC,QAASC,QAASC,qBAC7BC,MAAQC,SAASC,eAAeJ,SAChCK,OAASH,MAAAA,aAAAA,MAAOI,MAAMC,cACtBC,MAAQL,SAASC,eAAeL,SAChCU,KAAOD,MAAAA,aAAAA,MAAOE,qBAAqB,SAEpCD,SAIA,IAAIE,EAAI,EAAGA,EAAIF,KAAKG,OAAQD,IAAK,OAC5BE,KAAOJ,KAAKE,GAAGD,qBAAqB,MAAMT,gBAC5CY,KAAM,OACAC,UAAYD,KAAKE,aAAeF,KAAKG,UAC3CP,KAAKE,GAAGM,MAAMC,QAAUJ,UAAUP,cAAcY,SAASd,QAAU,GAAK,UAU9Ee,UAAY,CAACrB,QAASE,qBAClBO,MAAQL,SAASC,eAAeL,SAChCU,KAAOY,MAAMC,MAAKd,MAAAA,aAAAA,MAAOC,OAAQ,IAAIc,MAAM,MAC7B,IAAhBd,KAAKG,oBAIHY,WAAaC,MAAMhB,KAAK,GAAGiB,MAAMzB,aAAae,WAC9CW,wCAAmC1B,aACnC2B,UAAkD,QAAtCpB,MAAMqB,aAAaF,eAErClB,KAAKqB,MAAK,CAACC,EAAGC,WACJC,OAASF,EAAEL,MAAMzB,aAAae,UAAUT,cACxC2B,OAASF,EAAEN,MAAMzB,aAAae,UAAUT,qBAE1CiB,UACOI,UACDO,WAAWF,QAAUE,WAAWD,QAChCC,WAAWD,QAAUC,WAAWF,QAEnCL,UACDK,OAAOG,cAAcF,QACrBA,OAAOE,cAAcH,WAI/BzB,MAAM6B,aAAaV,cAAeC,UAAY,MAAQ,cAGhDU,MAAQ9B,MAAM+B,cAAc,SAC9BD,QACAA,MAAME,UAAY,GAClB/B,KAAKgC,SAAQC,KAAOJ,MAAMK,YAAYD,QAG1CE,qBAAqBpC,MAAOP,YAAa2B,YASvCgB,qBAAuB,CAACpC,MAAOP,YAAa2B,aAC9BpB,MAAMqC,iBAAiB,MAC/BJ,SAAQ,CAACK,OAAQC,SACrBD,OAAOT,aACH,sBACAU,QAAU9C,YAAe2B,UAAY,IAAM,IAAO,2BAWrC,eAAC7B,+DAAU,YAAaC,+DAAU,uBAAwBgD,yEAAoB,KAE/FnD,kBAAkBE,sBAIhBS,MAAQL,SAASC,eAAeL,aACjCS,mBAICyC,QAAUzC,MAAMqC,iBAAiB,MACvCI,QAAQR,SAAQ,CAACK,OAAQC,SACrBD,OAAOI,iBAAiB,SAAS,IAAM9B,UAAUrB,QAASgD,kBAGxD7C,MAAQC,SAASC,eAAeJ,SAClCE,OACAA,MAAMgD,iBAAiB,SAAS,IAAMpD,YAAYC,QAASC,QAASgD,qBAMxEnD,kBAAkBE,UAAW"}