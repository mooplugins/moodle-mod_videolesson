{"version":3,"file":"manage.min.js","sources":["../src/manage.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Manage functionality for videolesson plugin\n *\n * @module     mod_videolesson/manage\n * @copyright  2022-2026 BitKea Technologies LLP\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Ajax from 'core/ajax';\nimport ModalFactory from 'core/modal_factory';\nimport ModalEvents from 'core/modal_events';\nimport Templates from 'core/templates';\nimport {initializePlayer, getUrlParameter, getSubtitles, addSubtitleTracks} from 'mod_videolesson/script';\nimport Notification from \"core/notification\";\nimport {get_string as getString} from 'core/str';\nimport {init as initFolders, ensureFolderTreeData, loadFolderTree} from 'mod_videolesson/folders';\nimport 'core/inplace_editable';\nimport * as Toast from 'core/toast';\nimport * as Debug from 'mod_videolesson/debug';\n\nlet currentFolder = 0;\nlet currentSearch = '';\nlet currentPage = 0;\nlet perPage = 10;\nlet tableContainer;\nlet isLoading = false;\n\nlet videoPlayer; // eslint-disable-line no-unused-vars\nconst folderParamToId = (value) => {\n    if (value === null || value === undefined || value === '' || value === 'all') {\n        return 0;\n    }\n    if (value === 'uncategorized' || value === 'null') {\n        return null;\n    }\n    const parsed = parseInt(value, 10);\n    return Number.isNaN(parsed) ? 0 : parsed;\n};\n\nconst folderIdToParam = (value) => {\n    if (value === null) {\n        return 'uncategorized';\n    }\n    if (value === 0 || value === undefined) {\n        return 'all';\n    }\n    return String(value);\n};\n\nconst stateDefaults = () => {\n    tableContainer = document.getElementById('videolesson-table-container');\n    if (!tableContainer) {\n        return;\n    }\n    currentFolder = folderParamToId(tableContainer.dataset.initialFolder || 'all');\n    currentSearch = tableContainer.dataset.initialSearch || '';\n    currentPage = parseInt(tableContainer.dataset.initialPage || '0', 10);\n    perPage = parseInt(tableContainer.dataset.perPage || '10', 10);\n};\n\nconst showTableSpinner = () => {\n    if (tableContainer) {\n        tableContainer.classList.add('videolesson-loading');\n    }\n};\n\nconst hideTableSpinner = () => {\n    if (tableContainer) {\n        tableContainer.classList.remove('videolesson-loading');\n    }\n};\n\nconst updateHistory = (replace = false) => {\n    const url = new URL(window.location.href);\n    const folderParam = folderIdToParam(currentFolder);\n    if (folderParam === 'all') {\n        url.searchParams.delete('folder');\n    } else {\n        url.searchParams.set('folder', folderParam);\n    }\n    url.searchParams.delete('folderid');\n\n    if (currentSearch) {\n        url.searchParams.set('search', currentSearch);\n    } else {\n        url.searchParams.delete('search');\n    }\n\n    url.searchParams.set('vpage', currentPage);\n    url.searchParams.set('vperpage', perPage);\n\n    const state = {\n        folder: folderParam,\n        search: currentSearch,\n        page: currentPage\n    };\n\n    if (replace) {\n        window.history.replaceState(state, '', url.toString());\n    } else {\n        window.history.pushState(state, '', url.toString());\n    }\n};\n\nconst highlightFolder = (folder) => {\n    document.dispatchEvent(new CustomEvent('videolesson:set-folder', {\n        detail: {folderId: folder}\n    }));\n};\n\nconst loadVideos = async ({folderId = currentFolder, search = currentSearch,\n        page = currentPage, pushState = true, replaceState = false} = {}) => {\n    if (isLoading) {\n        return;\n    }\n\n    if (!tableContainer) {\n        tableContainer = document.getElementById('videolesson-table-container');\n    }\n\n    if (!tableContainer) {\n        return;\n    }\n\n    isLoading = true;\n    showTableSpinner();\n\n    try {\n        const folderParam = folderIdToParam(folderId);\n        const response = await Ajax.call([{\n            methodname: 'mod_videolesson_get_videos',\n            args: {\n                folderid: folderParam,\n                search: search,\n                page: page,\n                perpage: perPage\n            }\n        }])[0];\n\n        const html = await Templates.render('mod_videolesson/library_table', response);\n        const wrapper = tableContainer.querySelector('#videolesson-table-wrapper');\n        if (wrapper) {\n            wrapper.outerHTML = html;\n        } else {\n            tableContainer.insertAdjacentHTML('beforeend', html);\n        }\n\n        currentFolder = folderParamToId(response.filters.folderid);\n        currentSearch = response.filters.search;\n        currentPage = response.pagination.page;\n        perPage = response.pagination.perpage;\n\n        highlightFolder(currentFolder);\n        setupBulkActions();\n        initTableSorting();\n        if (pushState) {\n            updateHistory(replaceState);\n        }\n    } catch (error) {\n        Notification.exception(error);\n    } finally {\n        hideTableSpinner();\n        isLoading = false;\n    }\n};\n\n/**\n * Initialize table sorting\n */\nconst initTableSorting = () => {\n    const table = document.getElementById('videolesson-table');\n    if (!table) {\n        return;\n    }\n\n    const sortableHeaders = table.querySelectorAll('th.videolesson-sortable');\n    let currentSort = {\n        column: null,\n        direction: 'asc' // 'asc' or 'desc'\n    };\n\n    sortableHeaders.forEach(header => {\n        header.style.cursor = 'pointer';\n        header.style.userSelect = 'none';\n\n        header.addEventListener('click', () => {\n            const column = header.getAttribute('data-sort-column');\n\n            // Toggle direction if clicking the same column\n            if (currentSort.column === column) {\n                currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';\n            } else {\n                currentSort.column = column;\n                currentSort.direction = 'asc';\n            }\n\n            // Update indicators\n            sortableHeaders.forEach(h => {\n                const indicator = h.querySelector('.sort-indicator');\n                if (indicator) {\n                    indicator.textContent = '';\n                }\n            });\n\n            const indicator = header.querySelector('.sort-indicator');\n            if (indicator) {\n                indicator.textContent = currentSort.direction === 'asc' ? ' ▲' : ' ▼';\n            }\n\n            // Sort the table\n            sortTableRows(table, column, currentSort.direction);\n        });\n    });\n};\n\n/**\n * Sort table rows by column\n * @param {HTMLElement} table - The table element.\n * @param {string} column - The column to sort.\n * @param {string} direction - The direction to sort.\n */\nconst sortTableRows = (table, column, direction) => {\n    const tbody = table.querySelector('tbody');\n    if (!tbody) {\n        return;\n    }\n\n    const rows = Array.from(tbody.querySelectorAll('tr:not(.d-none)'));\n\n    rows.sort((a, b) => {\n        const aValue = a.getAttribute(`data-sort-${column}`) || '';\n        const bValue = b.getAttribute(`data-sort-${column}`) || '';\n\n        // Handle numeric columns\n        if (column === 'instances' || column === 'timecreated') {\n            const aNum = parseFloat(aValue) || 0;\n            const bNum = parseFloat(bValue) || 0;\n            return direction === 'asc' ? aNum - bNum : bNum - aNum;\n        }\n\n        // Handle text columns\n        const aText = aValue.toLowerCase();\n        const bText = bValue.toLowerCase();\n\n        if (direction === 'asc') {\n            return aText.localeCompare(bText);\n        } else {\n            return bText.localeCompare(aText);\n        }\n    });\n\n    // Clear and re-append sorted rows\n    tbody.innerHTML = '';\n    rows.forEach(row => tbody.appendChild(row));\n\n    // Re-attach event listeners (if needed)\n    setupBulkActions();\n};\n/**\n * Flatten folder options\n * @param {Array<Object>} folders - The folders to flatten.\n * @param {number} selectedId - The selected ID.\n * @param {number} depth - The depth of the folders.\n * @return {Array<Object>} The flattened folder options.\n */\nconst flattenFolderOptions = (folders, selectedId = null, depth = 0) => {\n    let options = [];\n    folders.forEach(folder => {\n        // Skip folders at depth 2 or higher (max depth is 3, so depth 2 cannot be a parent)\n        if (folder.depth >= 2) {\n            // Don't add this folder as a parent option\n            return;\n        }\n        const indent = depth > 0 ? `${'— '.repeat(depth)}` : '';\n        options.push({\n            value: folder.id,\n            label: `${indent}${folder.name}`,\n            selected: selectedId !== null && parseInt(folder.id, 10) === parseInt(selectedId, 10)\n        });\n        if (folder.children && folder.children.length) {\n            options = options.concat(flattenFolderOptions(folder.children, selectedId, depth + 1));\n        }\n    });\n    return options;\n};\n\n/**\n * Get selected video IDs from checkboxes\n * @return {Array<number>} Array of selected video IDs\n */\nconst getSelectedVideoIds = () => {\n    const checkboxes = document.querySelectorAll('.videolesson-video-checkbox:checked');\n    return Array.from(checkboxes).map(cb => parseInt(cb.dataset.videoId, 10));\n};\n\n/**\n * Update bulk actions toolbar visibility and selected count\n * @return {void}\n */\nconst updateBulkActions = () => {\n    const selectedIds = getSelectedVideoIds();\n    const bulkActions = document.getElementById('videolesson-bulk-actions');\n    const selectedCount = document.getElementById('videolesson-selected-count');\n    const selectAll = document.getElementById('videolesson-select-all');\n\n    if (bulkActions && selectedCount) {\n        if (selectedIds.length > 0) {\n            bulkActions.classList.remove('d-none');\n            getString('bulk:selected_count', 'mod_videolesson').then(str => {\n                selectedCount.textContent = `${selectedIds.length} ${str}`;\n            });\n        } else {\n            bulkActions.classList.add('d-none');\n        }\n    }\n\n    // Update select all checkbox state\n    if (selectAll) {\n        const allCheckboxes = document.querySelectorAll('.videolesson-video-checkbox');\n        const checkedCount = document.querySelectorAll('.videolesson-video-checkbox:checked').length;\n        selectAll.checked = allCheckboxes.length > 0 && checkedCount === allCheckboxes.length;\n        selectAll.indeterminate = checkedCount > 0 && checkedCount < allCheckboxes.length;\n    }\n};\n\n/**\n * Setup bulk action event listeners\n * @return {void}\n */\nconst setupBulkActions = () => {\n    const selectAll = document.getElementById('videolesson-select-all');\n    const bulkMove = document.querySelector('.videolesson-bulk-move');\n    const bulkDelete = document.querySelector('.videolesson-bulk-delete');\n\n    // Select all checkbox\n    if (selectAll) {\n        selectAll.addEventListener('change', (e) => {\n            const checkboxes = document.querySelectorAll('.videolesson-video-checkbox');\n            checkboxes.forEach(cb => {\n                cb.checked = e.target.checked;\n            });\n            updateBulkActions();\n        });\n    }\n\n    // Individual checkboxes\n    document.querySelectorAll('.videolesson-video-checkbox').forEach(checkbox => {\n        checkbox.addEventListener('change', () => {\n            updateBulkActions();\n        });\n    });\n\n    // Bulk move button\n    if (bulkMove) {\n        bulkMove.addEventListener('click', async (e) => {\n            e.preventDefault();\n            const selectedIds = getSelectedVideoIds();\n            if (selectedIds.length === 0) {\n                Toast.add(await getString('bulk:no_selection', 'mod_videolesson'), {type: 'error'});\n                return;\n            }\n            await handleBulkMove(selectedIds);\n        });\n    }\n\n    // Bulk delete button\n    if (bulkDelete) {\n        bulkDelete.addEventListener('click', async (e) => {\n            e.preventDefault();\n            const selectedIds = getSelectedVideoIds();\n            if (selectedIds.length === 0) {\n                Toast.add(await getString('bulk:no_selection', 'mod_videolesson'), {type: 'error'});\n                return;\n            }\n            await handleBulkDelete(selectedIds);\n        });\n    }\n\n    // Initialize bulk actions state\n    updateBulkActions();\n};\n\n/**\n * Get loading body HTML with spinner\n * @param {string} message Optional loading message\n * @return {string} HTML string for loading body\n */\nconst getLoadingBody = (message = 'Loading...') => {\n    return '<div class=\"text-center p-3\">' +\n        '<div class=\"spinner-border text-primary\" role=\"status\">' +\n        '<span class=\"sr-only\">Loading...</span>' +\n        '</div>' +\n        (message ? `<p class=\"mt-2\">${message}</p>` : '') +\n        '</div>';\n};\n\n/**\n * Handle bulk move operation\n * @param {Array<number>} videoIds Array of video IDs to move\n */\nconst handleBulkMove = async (videoIds) => {\n    try {\n        const [title, selectLabel, uncategorizedLabel] = await Promise.all([\n            getString('bulk:move', 'mod_videolesson'),\n            getString('folder:select', 'mod_videolesson'),\n            getString('folder:uncategorized', 'mod_videolesson')\n        ]);\n\n        // Show modal immediately with loading state\n        const loadingBody = getLoadingBody('Loading folders...');\n\n        const modal = await ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: title,\n            body: loadingBody\n        });\n\n        modal.show();\n\n        // Determine which folder to pre-select (do this while modal is showing)\n        // First, check if all selected videos are in the same folder\n        const selectedCheckboxes = document.querySelectorAll('.videolesson-video-checkbox:checked');\n        const folderIds = new Set();\n        let defaultFolderId = null;\n\n        selectedCheckboxes.forEach(checkbox => {\n            const row = checkbox.closest('tr.videolesson-draggable-row');\n            if (row) {\n                const folderIdAttr = row.getAttribute('data-folder-id');\n                if (folderIdAttr && folderIdAttr !== 'null') {\n                    folderIds.add(folderIdAttr);\n                }\n            }\n        });\n\n        // If all selected videos are in the same folder, use that folder\n        if (folderIds.size === 1) {\n            const folderIdValue = Array.from(folderIds)[0];\n            defaultFolderId = folderIdValue === 'null' ? null : parseInt(folderIdValue, 10);\n        } else {\n            // Otherwise, use the current active folder (if it's not \"all videos\")\n            if (currentFolder !== null && currentFolder !== 0) {\n                defaultFolderId = currentFolder;\n            }\n        }\n\n        // Load folder tree data in background\n        const tree = await ensureFolderTreeData();\n        const options = [\n            {value: '', label: uncategorizedLabel, selected: defaultFolderId === null},\n            ...flattenFolderOptions(tree, defaultFolderId)\n        ];\n\n        const body = await Templates.render('mod_videolesson/assign_folder_modal', {\n            label: selectLabel,\n            options: options\n        });\n\n        // Update modal body with actual content\n        modal.getRoot().find('.modal-body').html(body);\n\n        modal.getRoot().on(ModalEvents.save, async () => {\n            const selected = modal.getRoot().find('#videolesson-assign-folder-select').val();\n            const folderId = selected === '' ? null : parseInt(selected, 10);\n\n            try {\n                const response = await Ajax.call([{\n                    methodname: 'mod_videolesson_bulk_move_videos',\n                    args: {\n                        videoids: videoIds,\n                        folderid: folderId\n                    }\n                }])[0];\n\n                if (response.success) {\n                    const msg = await getString('bulk:move_success', 'mod_videolesson');\n                    Toast.add(msg);\n                    modal.destroy();\n                    await loadFolderTree();\n                    await loadVideos({\n                        folderId: currentFolder,\n                        search: currentSearch,\n                        page: currentPage,\n                        pushState: false,\n                        replaceState: true\n                    });\n                } else {\n                    Toast.add(response.error || await getString('bulk:error', 'mod_videolesson'), {type: 'error'});\n                }\n            } catch (error) {\n                Notification.exception(error);\n            }\n        });\n\n        modal.show();\n    } catch (error) {\n        Notification.exception(error);\n    }\n};\n\n/**\n * Handle single video delete operation\n * @param {number} videoId Video ID to delete\n * @param {string} videoName Video name for confirmation message\n */\nconst handleSingleVideoDelete = async (videoId, videoName = '') => {\n    try {\n        const [confirmTitle, confirmBody, cancelText, yesText] = await Promise.all([\n            getString('confirmation', 'mod_videolesson'),\n            getString('manage:video:delete:confirm', 'mod_videolesson').then(msg =>\n                videoName ? msg.replace('{$a}', videoName) : msg.replace('{$a}', 'this video')\n            ),\n            getString('cancel'),\n            getString('yes', 'moodle')\n        ]);\n\n        const modal = await ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: confirmTitle,\n            body: confirmBody,\n            buttons: {\n                cancel: cancelText,\n                save: yesText\n            }\n        });\n\n        // Use 'one' to handle save event only once and prevent auto-close\n        modal.getRoot().one(ModalEvents.save, function(e) {\n            // Prevent modal from auto-closing - must be synchronous and non-async\n            e.preventDefault();\n            e.stopPropagation();\n\n            // Now handle the async logic\n            (async () => {\n                // Show loading state in modal\n                const loadingBody = getLoadingBody('Deleting video...');\n                modal.getRoot().find('.modal-body').html(loadingBody);\n\n                // Disable buttons during loading\n                modal.getRoot().find('[data-action=\"save\"]').prop('disabled', true);\n                modal.getRoot().find('[data-action=\"cancel\"]').prop('disabled', true);\n\n                try {\n                    const response = await Ajax.call([{\n                        methodname: 'mod_videolesson_bulk_delete_videos',\n                        args: {\n                            videoids: [videoId]\n                        }\n                    }])[0];\n\n                    // Close modal immediately after response\n                    modal.destroy();\n\n                    if (response.success) {\n                        const msg = await getString('success:delete', 'mod_videolesson');\n                        Toast.add(msg);\n                        await loadFolderTree();\n                        await loadVideos({\n                            folderId: currentFolder,\n                            search: currentSearch,\n                            page: currentPage,\n                            pushState: false,\n                            replaceState: true\n                        });\n                    } else {\n                        const errorMsg = response.errors && response.errors.length > 0\n                            ? response.errors.join(', ')\n                            : await getString('bulk:error', 'mod_videolesson');\n                        Toast.add(errorMsg, {type: 'error'});\n                    }\n                } catch (error) {\n                    // Close modal on error\n                    modal.destroy();\n\n                    // Show error notification\n                    Notification.exception(error);\n                }\n            })(); // Close async IIFE\n        });\n\n        modal.show();\n    } catch (error) {\n        Notification.exception(error);\n    }\n};\n\n/**\n * Handle bulk delete operation\n * @param {Array<number>} videoIds Array of video IDs to delete\n */\n/**\n * Handle subtitle generation\n * @param {string} contenthash Video content hash\n * @param {string} videoName Video name for display\n */\n// eslint-disable-next-line no-unused-vars\nconst handleSubtitleGeneration = async (contenthash, videoName = '') => {\n    try {\n        // Show modal immediately with loading state\n        const [modalTitle, cancelText, submitText] = await Promise.all([\n            getString('subtitle:modal:title', 'mod_videolesson'),\n            getString('cancel'),\n            getString('subtitle:modal:submit', 'mod_videolesson')\n        ]);\n\n        const loadingBody = getLoadingBody('Loading...');\n\n        const modal = await ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: modalTitle,\n            body: loadingBody,\n            buttons: {\n                cancel: cancelText,\n                save: submitText\n            }\n        });\n\n        modal.show();\n\n        // Fetch supported languages and existing subtitles in background\n        const languagesResponse = await Ajax.call([{\n            methodname: 'mod_videolesson_get_subtitle_languages',\n            args: {\n                contenthash: contenthash\n            }\n        }])[0];\n\n        const languages = languagesResponse.languages || [];\n        const existing = languagesResponse.existing || [];\n        const pending = languagesResponse.pending || [];\n        const processing = languagesResponse.processing || [];\n        const failed = languagesResponse.failed || [];\n\n        // Count existing languages excluding 'original'\n        // Also exclude pending/processing from the count since they're already requested\n        // Handle both old format (string) and new format (object with code/name)\n        const existingCount = existing.filter(lang => {\n            const code = typeof lang === 'string' ? lang : (lang.code || '');\n            return code !== 'original';\n        }).length;\n        // Handle both old format (string) and new format (object with code/name) for pending/processing\n        const pendingProcessingCount = (pending.length + processing.length);\n        const maxSelectable = 5 - existingCount - pendingProcessingCount;\n        const canSelectMore = maxSelectable > 0;\n\n        // Show all available languages (excluding already selected ones)\n        // The selection limit is enforced in validation, not by limiting the list\n        const selectableLanguages = canSelectMore ? languages : [];\n\n        const body = await Templates.render('mod_videolesson/subtitle_modal', {\n            languages: selectableLanguages,\n            existing: existing,\n            pending: pending,\n            processing: processing,\n            failed: failed,\n            maxSelectable: maxSelectable,\n            canSelectMore: canSelectMore\n        });\n\n        // Update modal body with actual content\n        modal.getRoot().find('.modal-body').html(body);\n\n        // Use 'one' to handle save event only once and prevent auto-close\n        modal.getRoot().one(ModalEvents.save, function(e) {\n            // Prevent modal from auto-closing - must be synchronous and non-async\n            e.preventDefault();\n            e.stopPropagation();\n\n            // Now handle the async logic\n            (async () => {\n\n            if (!canSelectMore) {\n                const remainingMsg = await getString('subtitle:modal:remaining', 'mod_videolesson').then(msg =>\n                    msg.replace('{$a}', '0')\n                );\n                Toast.add(remainingMsg, {type: 'error'});\n                return;\n            }\n\n            const select = modal.getRoot().find('#subtitle-language-select');\n            const selectedOptions = Array.from(select[0].selectedOptions);\n            const selectedLanguages = selectedOptions.map(opt => opt.value);\n\n            if (selectedLanguages.length === 0) {\n                Toast.add(await getString('subtitle:select_language', 'mod_videolesson'), {type: 'error'});\n                return;\n            }\n\n            // Check if any selected languages are pending/processing (shouldn't happen, but double-check)\n            // Handle both old format (string) and new format (object with code/name)\n            const pendingCodes = pending.map(lang => typeof lang === 'string' ? lang : (lang.code || ''));\n            const processingCodes = processing.map(lang => typeof lang === 'string' ? lang : (lang.code || ''));\n            const allPendingProcessing = [...pendingCodes, ...processingCodes];\n            const invalidSelections = selectedLanguages.filter(lang => allPendingProcessing.includes(lang));\n            if (invalidSelections.length > 0) {\n                Toast.add(await getString('error:subtitle:already_requested', 'mod_videolesson'), {type: 'error'});\n                return;\n            }\n\n            // Also check against existing languages\n            const existingCodes = existing.map(lang => typeof lang === 'string' ? lang : (lang.code || ''));\n            const duplicateSelections = selectedLanguages.filter(lang => existingCodes.includes(lang));\n            if (duplicateSelections.length > 0) {\n                Toast.add(await getString('error:subtitle:already_requested', 'mod_videolesson'), {type: 'error'});\n                return;\n            }\n\n            if (selectedLanguages.length > maxSelectable) {\n                const remainingMsg = await getString('subtitle:modal:remaining', 'mod_videolesson').then(msg =>\n                    msg.replace('{$a}', maxSelectable.toString())\n                );\n                Toast.add(remainingMsg, {type: 'error'});\n                return;\n            }\n\n            const langString = selectedLanguages.join(',');\n\n            // Show loading state in modal\n            const loadingBody = getLoadingBody('Processing subtitle request...');\n            modal.getRoot().find('.modal-body').html(loadingBody);\n\n            // Disable buttons during loading\n            modal.getRoot().find('[data-action=\"save\"]').prop('disabled', true);\n            modal.getRoot().find('[data-action=\"cancel\"]').prop('disabled', true);\n\n            try {\n                const response = await Ajax.call([{\n                    methodname: 'mod_videolesson_trigger_subtitle',\n                    args: {\n                        contenthash: contenthash,\n                        lang: langString\n                    }\n                }])[0];\n\n                // Close modal immediately after response\n                modal.destroy();\n\n                // Show toast notification with result\n                const [successMsg, errorMsg] = await Promise.all([\n                    getString('success:subtitle:triggered', 'mod_videolesson'),\n                    getString('error:subtitle:trigger_failed', 'mod_videolesson')\n                ]);\n                const resultMessage = response.success\n                    ? (response.message || successMsg)\n                    : (response.message || errorMsg);\n                const resultType = response.success ? 'success' : 'error';\n\n                Toast.add(resultMessage, {type: resultType});\n            } catch (error) {\n                // Close modal on error\n                modal.destroy();\n\n                // Show error notification\n                Notification.exception(error);\n            }\n            })(); // Close async IIFE\n        });\n\n        modal.show();\n    } catch (error) {\n        Notification.exception(error);\n    }\n};\n\nconst handleBulkDelete = async (videoIds) => {\n    try {\n        const [confirmTitle, confirmBody, cancelText, yesText] = await Promise.all([\n            getString('confirmation', 'mod_videolesson'),\n            getString('bulk:confirm_delete', 'mod_videolesson').then(msg =>\n                msg.replace('{$a}', videoIds.length)\n            ),\n            getString('cancel'),\n            getString('yes', 'moodle')\n        ]);\n\n        const modal = await ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: confirmTitle,\n            body: confirmBody,\n            buttons: {\n                cancel: cancelText,\n                save: yesText\n            }\n        });\n\n        // Use 'one' to handle save event only once and prevent auto-close\n        modal.getRoot().one(ModalEvents.save, function(e) {\n            // Prevent modal from auto-closing - must be synchronous and non-async\n            e.preventDefault();\n            e.stopPropagation();\n\n            // Now handle the async logic\n            (async () => {\n                // Show loading state in modal\n                const loadingBody = getLoadingBody('Deleting videos...');\n                modal.getRoot().find('.modal-body').html(loadingBody);\n\n                // Disable buttons during loading\n                modal.getRoot().find('[data-action=\"save\"]').prop('disabled', true);\n                modal.getRoot().find('[data-action=\"cancel\"]').prop('disabled', true);\n\n                try {\n                    const response = await Ajax.call([{\n                        methodname: 'mod_videolesson_bulk_delete_videos',\n                        args: {\n                            videoids: videoIds\n                        }\n                    }])[0];\n\n                    // Close modal immediately after response\n                    modal.destroy();\n\n                    if (response.success) {\n                        const msg = await getString('bulk:delete_success', 'mod_videolesson');\n                        Toast.add(msg);\n                        await loadVideos({\n                            folderId: currentFolder,\n                            search: currentSearch,\n                            page: currentPage,\n                            pushState: false,\n                            replaceState: true\n                        });\n                        await loadFolderTree();\n                    } else {\n                        Toast.add(response.error || await getString('bulk:error', 'mod_videolesson'), {type: 'error'});\n                    }\n                } catch (error) {\n                    // Close modal on error\n                    modal.destroy();\n\n                    // Show error notification\n                    Notification.exception(error);\n                }\n            })(); // Close async IIFE\n        });\n\n        modal.show();\n    } catch (error) {\n        Notification.exception(error);\n    }\n};\n\nconst assignFolder = async (videoId, folderValue) => {\n    const targetFolder = folderValue === null ? null : parseInt(folderValue, 10);\n    try {\n        const response = await Ajax.call([{\n            methodname: 'mod_videolesson_move_video',\n            args: {\n                videolessonid: parseInt(videoId, 10),\n                folderid: targetFolder\n            }\n        }])[0];\n\n        if (response.success) {\n            const msg = await getString('folder:move_video_success', 'mod_videolesson');\n            Toast.add(msg);\n            await loadFolderTree();\n            await loadVideos({\n                folderId: currentFolder,\n                search: currentSearch,\n                page: currentPage,\n                pushState: false,\n                replaceState: true\n            });\n        } else {\n            Toast.add(response.error || await getString('folder:move_video_error', 'mod_videolesson'), {type: 'error'});\n        }\n    } catch (error) {\n        Notification.exception(error);\n    }\n};\n\nconst showAssignFolderModal = async (videoId, currentFolderValue, videoTitle = '') => {\n    try {\n        // Show modal immediately with loading state\n        const [title, selectLabel, uncategorizedLabel] = await Promise.all([\n            getString('folder:assign', 'mod_videolesson'),\n            getString('folder:select', 'mod_videolesson'),\n            getString('folder:uncategorized', 'mod_videolesson')\n        ]);\n\n        const loadingBody = getLoadingBody('Loading folders...');\n\n        const modal = await ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: title,\n            body: loadingBody\n        });\n\n        modal.show();\n\n        // Load folder tree data in background\n        const tree = await ensureFolderTreeData();\n        const currentFolderId = currentFolderValue === undefined || currentFolderValue === '' || currentFolderValue === 'null'\n            ? null : parseInt(currentFolderValue, 10);\n        const options = [\n            {value: '', label: uncategorizedLabel, selected: currentFolderId === null},\n            ...flattenFolderOptions(tree, currentFolderId)\n        ];\n\n        const body = await Templates.render('mod_videolesson/assign_folder_modal', {\n            label: selectLabel,\n            options: options,\n            videotitle: videoTitle\n        });\n\n        // Update modal body with actual content\n        modal.getRoot().find('.modal-body').html(body);\n\n        modal.getRoot().on(ModalEvents.save, async () => {\n            const selected = modal.getRoot().find('#videolesson-assign-folder-select').val();\n            const folderId = selected === '' ? null : parseInt(selected, 10);\n            await assignFolder(videoId, folderId);\n            modal.destroy();\n        });\n\n        modal.show();\n    } catch (error) {\n        Notification.exception(error);\n    }\n};\n\nconst showLoader = () => {\n    document.getElementById('videolesson-modal-loading').style.display = 'flex';\n};\n\nconst hideLoader = () => {\n    document.getElementById('videolesson-modal-loading').style.display = 'none';\n};\n\nconst viewVideoModal = async (params) => {\n    showLoader();\n    const renderedBody = await Templates.render('mod_videolesson/view_modal', params);\n\n    let tracks = [];\n    try {\n        tracks = await getSubtitles(params.contenthash);\n    } catch (error) {\n        Debug.error('Error fetching subtitles', error);\n        Notification.exception(error);\n    }\n\n    ModalFactory.create({\n        title: params.title,\n        body: renderedBody,\n        type: ModalFactory.types.CANCEL,\n        footer: '',\n        large: true\n    }).then(function(modal) {\n        modal.getRoot().on(ModalEvents.hidden, function() {\n            modal.destroy();\n        });\n        modal.getRoot().on(ModalEvents.shown, function() {\n            let v = modal.getRoot().find('#player')[0],\n            c = modal.getRoot().find('#player-container-div')[0],\n            p = modal.getRoot().find('#player-placeholder')[0];\n\n            let params = {\n                ishls: true,\n                video: v,\n            };\n\n            addSubtitleTracks(v, tracks);\n            initializePlayer(params)\n            .then((videoPlyr) => {\n                videoPlayer = videoPlyr;\n            })\n            .then(() => {\n                c.classList.remove('d-none');\n                p.classList.add('d-none');\n            });\n        });\n        hideLoader();\n        modal.show();\n        return true;\n    }).catch(Notification.exception);\n};\n\nexport const init = () => {\n    stateDefaults();\n\n    window.onload = function() {\n        const action = getUrlParameter('action');\n        if (action === 'view') {\n            const src = getUrlParameter('src');\n            const title = getUrlParameter('title');\n            if (src !== '') {\n                viewVideoModal({sourceurl: src, title: title});\n            }\n        }\n    };\n\n    if (document.querySelector('.videolesson-folder-tree-container')) {\n        initFolders(currentFolder);\n        document.addEventListener('videolesson:folder:selected', (e) => {\n            const folderId = (e.detail && typeof e.detail.folderId !== 'undefined')\n                ? e.detail.folderId\n                : folderParamToId(e.detail.folder);\n            loadVideos({folderId: folderId, page: 0});\n        });\n    }\n\n    const filterForm = document.querySelector('form[name=\"filter-videos\"]');\n    if (filterForm) {\n        const searchInput = filterForm.querySelector('input[name=\"_text\"]');\n        const resetButton = filterForm.querySelector('button[value=\"reset\"]');\n\n        filterForm.addEventListener('submit', (e) => {\n            e.preventDefault();\n            const value = searchInput ? searchInput.value : '';\n            loadVideos({folderId: currentFolder, search: value, page: 0});\n        });\n\n        if (resetButton) {\n            resetButton.addEventListener('click', (e) => {\n                e.preventDefault();\n                if (searchInput) {\n                    searchInput.value = '';\n                }\n                loadVideos({folderId: currentFolder, search: '', page: 0});\n            });\n        }\n    }\n\n    document.body.addEventListener('click', function(event) {\n        const target = event.target;\n\n        const legacyLink = target.closest('.videolesson-viewmodal-href');\n        if (legacyLink){\n            event.preventDefault();\n            const fragment = legacyLink.getAttribute(\"href\");\n            const url = new URL(\"http://dummy.com\" + fragment);\n            const params = new URLSearchParams(url.hash.substring(1));\n            const src = params.get('videolesson-src');\n            const hash = legacyLink.getAttribute('data-videolesson-contenthash');\n            let modalparams = { sourceurl: src, title: legacyLink.textContent.trim(), contenthash: hash};\n            viewVideoModal(modalparams);\n        }\n\n        const viewBtn = target.closest('.videolesson-viewmodal-data');\n        if (viewBtn){\n            event.preventDefault();\n            const src = viewBtn.getAttribute('data-videolesson-src');\n            const hash = viewBtn.getAttribute('data-videolesson-contenthash');\n            const title = viewBtn.getAttribute('data-videolesson-title') || '';\n            const modalparams = { sourceurl: src, title: title, contenthash: hash };\n            viewVideoModal(modalparams);\n        }\n\n        // Handle thumbnail click\n        const thumbnail = target.closest('.videolesson-viewmodal-thumbnail');\n        if (thumbnail) {\n            event.preventDefault();\n            const src = thumbnail.getAttribute('data-videolesson-src');\n            const hash = thumbnail.getAttribute('data-videolesson-contenthash');\n            const title = thumbnail.getAttribute('data-videolesson-title') || '';\n            const modalparams = { sourceurl: src, title: title, contenthash: hash };\n            viewVideoModal(modalparams);\n        }\n\n        const paginate = target.closest('.videolesson-page-link');\n        if (paginate) {\n            event.preventDefault();\n            const nextpage = parseInt(paginate.dataset.page, 10);\n            if (!Number.isNaN(nextpage)) {\n                loadVideos({page: nextpage});\n            }\n        }\n\n        // Handle filter removal\n        const removeFilterBtn = target.closest('.videolesson-remove-filter');\n        if (removeFilterBtn) {\n            event.preventDefault();\n            event.stopPropagation();\n            const badge = removeFilterBtn.closest('.videolesson-filter-badge');\n            if (badge) {\n                const filterType = badge.getAttribute('data-filter-type');\n                if (filterType === 'search') {\n                    currentSearch = '';\n                    updateHistory(true);\n                    loadVideos({\n                        folderId: currentFolder,\n                        search: '',\n                        page: 0,\n                        pushState: true,\n                        replaceState: false\n                    });\n                } else if (filterType === 'folder') {\n                    currentFolder = 0;\n                    updateHistory(true);\n                    loadVideos({\n                        folderId: 0,\n                        search: currentSearch,\n                        page: 0,\n                        pushState: true,\n                        replaceState: false\n                    });\n                }\n            }\n            return;\n        }\n\n        const refreshBtn = target.closest('.videolesson-refresh-table');\n        if (refreshBtn) {\n            event.preventDefault();\n            loadVideos({pushState: false, replaceState: true});\n        }\n\n        const assignBtn = target.closest('.videolesson-assign-folder');\n        if (assignBtn) {\n            event.preventDefault();\n            const videoId = assignBtn.getAttribute('data-videolesson-id');\n            const currentFolderValue = assignBtn.getAttribute('data-current-folder');\n            const videoTitle = assignBtn.getAttribute('data-video-title') || '';\n            showAssignFolderModal(videoId, currentFolderValue, videoTitle);\n        }\n\n        const deleteLink = target.closest('.videolesson-delete-link');\n        if (deleteLink) {\n            console.log('deleteLink', deleteLink); // eslint-disable-line no-console\n            event.preventDefault();\n            const videoIdAttr = deleteLink.getAttribute('data-video-id') || deleteLink.dataset.videoId;\n            const videoName = deleteLink.getAttribute('data-video-name') || deleteLink.dataset.videoName || '';\n\n            if (videoIdAttr) {\n                const videoId = parseInt(videoIdAttr, 10);\n                if (!isNaN(videoId)) {\n                    handleSingleVideoDelete(videoId, videoName);\n                }\n            }\n        }\n\n    });\n\n    // Handle subtitle generation button clicks\n    document.addEventListener('click', async (e) => {\n        const subtitleBtn = e.target.closest('.videolesson-trigger-subtitle');\n        if (subtitleBtn) {\n            e.preventDefault();\n            const contenthash = subtitleBtn.getAttribute('data-contenthash') || subtitleBtn.dataset.contenthash;\n            const videoName = subtitleBtn.getAttribute('data-video-name') || subtitleBtn.dataset.videoName || '';\n            if (contenthash) {\n                await handleSubtitleGeneration(contenthash, videoName);\n            }\n        }\n    });\n\n    window.addEventListener('popstate', (e) => {\n        const state = e.state;\n        if (state) {\n            const folderId = folderParamToId(state.folder);\n            loadVideos({\n                folderId: folderId,\n                search: state.search || '',\n                page: state.page || 0,\n                pushState: false,\n                replaceState: true\n            });\n            highlightFolder(folderId);\n        } else {\n            const url = new URL(window.location.href);\n            const folderParam = url.searchParams.get('folder') || url.searchParams.get('folderid') || 'all';\n            const search = url.searchParams.get('search') || '';\n            const page = parseInt(url.searchParams.get('vpage') || '0', 10);\n            loadVideos({\n                folderId: folderParamToId(folderParam),\n                search: search,\n                page: page,\n                pushState: false,\n                replaceState: true\n            });\n            highlightFolder(folderParamToId(folderParam));\n        }\n    });\n\n    if (tableContainer) {\n        loadVideos({folderId: currentFolder, search: currentSearch, page: currentPage, pushState: false, replaceState: true});\n    }\n};\n"],"names":["tableContainer","videoPlayer","currentFolder","currentSearch","currentPage","perPage","isLoading","folderParamToId","value","parsed","parseInt","Number","isNaN","folderIdToParam","undefined","String","showTableSpinner","classList","add","hideTableSpinner","remove","updateHistory","replace","url","URL","window","location","href","folderParam","searchParams","delete","set","state","folder","search","page","history","replaceState","toString","pushState","highlightFolder","document","dispatchEvent","CustomEvent","detail","folderId","loadVideos","async","getElementById","response","Ajax","call","methodname","args","folderid","perpage","html","Templates","render","wrapper","querySelector","outerHTML","insertAdjacentHTML","filters","pagination","setupBulkActions","initTableSorting","error","exception","table","sortableHeaders","querySelectorAll","currentSort","column","direction","forEach","header","style","cursor","userSelect","addEventListener","getAttribute","h","indicator","textContent","sortTableRows","tbody","rows","Array","from","sort","a","b","aValue","bValue","aNum","parseFloat","bNum","aText","toLowerCase","bText","localeCompare","innerHTML","row","appendChild","flattenFolderOptions","folders","selectedId","depth","options","indent","repeat","push","id","label","name","selected","children","length","concat","getSelectedVideoIds","checkboxes","map","cb","dataset","videoId","updateBulkActions","selectedIds","bulkActions","selectedCount","selectAll","then","str","allCheckboxes","checkedCount","checked","indeterminate","bulkMove","bulkDelete","e","target","checkbox","preventDefault","handleBulkMove","Toast","type","handleBulkDelete","getLoadingBody","message","title","selectLabel","uncategorizedLabel","Promise","all","loadingBody","modal","ModalFactory","create","types","SAVE_CANCEL","body","show","selectedCheckboxes","folderIds","Set","defaultFolderId","closest","folderIdAttr","size","folderIdValue","tree","getRoot","find","on","ModalEvents","save","val","videoids","videoIds","success","msg","destroy","confirmTitle","confirmBody","cancelText","yesText","buttons","cancel","one","stopPropagation","prop","assignFolder","folderValue","targetFolder","videolessonid","viewVideoModal","display","renderedBody","params","tracks","contenthash","Debug","CANCEL","footer","large","hidden","shown","v","c","p","ishls","video","videoPlyr","catch","Notification","initialFolder","initialSearch","initialPage","onload","src","sourceurl","filterForm","searchInput","resetButton","event","legacyLink","fragment","URLSearchParams","hash","substring","get","modalparams","trim","viewBtn","thumbnail","paginate","nextpage","removeFilterBtn","badge","filterType","assignBtn","currentFolderValue","videoTitle","currentFolderId","videotitle","showAssignFolderModal","deleteLink","console","log","videoIdAttr","videoName","errorMsg","errors","join","handleSingleVideoDelete","subtitleBtn","modalTitle","submitText","languagesResponse","languages","existing","pending","processing","failed","maxSelectable","filter","lang","code","canSelectMore","selectableLanguages","remainingMsg","select","selectedLanguages","selectedOptions","opt","allPendingProcessing","includes","existingCodes","langString","successMsg","resultMessage","resultType","handleSubtitleGeneration"],"mappings":"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"}